{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\aline\\\\OneDrive\\\\Escritorio\\\\react-restaurantapp\\\\restaurantapp\\\\src\\\\componentes\\\\BuySection.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { messageGen, sendClient, sendManage } from '../functionsSendMail/functions';\nimport { Alert } from './Alert';\nimport '../css/carrito.css';\nimport ItemCompra from './ItemCompra';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst BuySection = () => {\n  _s();\n  const [lstorage, setLstorage] = useState([]);\n  const [user, setUser] = useState(null);\n  const [alertData, setAlertData] = useState({});\n  const [alertShow, setAlertShow] = useState(false);\n  useEffect(() => {\n    let data = localStorage.getItem('items');\n    const userData = localStorage.getItem('user');\n    if (data !== null) {\n      setLstorage(JSON.parse(data));\n    }\n    if (userData !== null) {\n      setUser(JSON.parse(userData));\n    }\n  }, []);\n  const data = JSON.parse(localStorage.getItem('items'));\n  const total = data !== null ? data.length > 0 ? data.map(item => item.proPrecio).reduce((a, b) => a + b) : 0 : 0;\n  const addCompra = () => {\n    (async () => {\n      const msg = messageGen(data);\n      const compra = {\n        comDescripcion: msg,\n        comPrecio: total,\n        usuId: user.usuId\n      };\n      const requestInit = {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'Application/json'\n        },\n        body: JSON.stringify(compra)\n      };\n      const peticion = await fetch(`https://app-restaurante-colnodo.herokuapp.com/compras`, requestInit);\n      console.log(peticion);\n    })();\n    const msg = messageGen(data);\n    sendClient(msg, user.usuCorreo, user.usuNombre);\n    sendManage(msg);\n    setAlertData({\n      message: 'Su orden de compra se ha efectuado correctamente',\n      type: 'success'\n    });\n    setAlertShow(true);\n    data.map(item => localStorage.removeItem(`item${item.proId}`));\n    localStorage.removeItem('items');\n    setLstorage([]);\n  };\n  const handleAlert = () => {\n    setAlertShow(false);\n  };\n  const DelItem = key => {\n    let data = JSON.parse(localStorage.getItem('items'));\n    data = data.filter(item => item.proId !== key);\n    setLstorage(data);\n    localStorage.setItem('items', JSON.stringify(data));\n    localStorage.removeItem(`item${key}`);\n  };\n  const editCompra = (key, counter) => {\n    let data = JSON.parse(localStorage.getItem('items'));\n    let modElement = data.find(item => item.proId === key);\n    let modData = data.filter(item => item.proId !== key);\n    const ogPrice = modElement.proPrecio / modElement.proCantidad;\n    modElement.proCantidad = counter;\n    modElement.proPrecio = ogPrice * counter;\n    data = [modElement, ...modData];\n    setLstorage(data);\n    localStorage.setItem('items', JSON.stringify(data));\n    localStorage.setItem(`item${modElement.proId}`, JSON.stringify(modElement));\n  };\n  const notFound = () => /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"not-found\",\n    id: \"not-found\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Lo sentimos\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"A\\xFAn no se ha introducido ning\\xFAn producto al carrito de compras, ingrese a nuestro men\\xFA para hacerlo\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 97,\n    columnNumber: 9\n  }, this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"buy-section\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"contenido_menu\",\n      id: \"contenido-menu\",\n      children: lstorage.length === 0 ? notFound() : lstorage.map(item => /*#__PURE__*/_jsxDEV(ItemCompra, {\n        local: item,\n        DelItem: DelItem,\n        Editcompra: editCompra\n      }, item.proId, false, {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 77\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"total-section\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"content\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"TOTAL\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          id: \"precio-total\",\n          children: total\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 17\n      }, this), user ? /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"button\",\n        onClick: () => addCompra(),\n        children: \"PAGAR AHORA\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 25\n      }, this) : /*#__PURE__*/_jsxDEV(\"a\", {\n        href: \"/login\",\n        children: \"PAGAR AHORA\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 98\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"liveAlertPlaceholder\",\n      children: alertShow ? /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(Alert, {\n          alerts: alertData,\n          reset: handleAlert\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 18\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 18\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 104,\n    columnNumber: 9\n  }, this);\n};\n_s(BuySection, \"KqgVtuj58TsZJntStaEaAuZZOh8=\");\n_c = BuySection;\nexport default BuySection;\nvar _c;\n$RefreshReg$(_c, \"BuySection\");","map":{"version":3,"names":["React","useState","useEffect","messageGen","sendClient","sendManage","Alert","ItemCompra","BuySection","lstorage","setLstorage","user","setUser","alertData","setAlertData","alertShow","setAlertShow","data","localStorage","getItem","userData","JSON","parse","total","length","map","item","proPrecio","reduce","a","b","addCompra","msg","compra","comDescripcion","comPrecio","usuId","requestInit","method","headers","body","stringify","peticion","fetch","console","log","usuCorreo","usuNombre","message","type","removeItem","proId","handleAlert","DelItem","key","filter","setItem","editCompra","counter","modElement","find","modData","ogPrice","proCantidad","notFound"],"sources":["C:/Users/aline/OneDrive/Escritorio/react-restaurantapp/restaurantapp/src/componentes/BuySection.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { messageGen, sendClient, sendManage } from '../functionsSendMail/functions';\nimport { Alert } from './Alert';\n\nimport '../css/carrito.css';\n\nimport ItemCompra from './ItemCompra';\n\nconst BuySection = () => {\n     \n    const [lstorage, setLstorage] = useState([]);\n    const [user, setUser] = useState(null);\n    const [alertData, setAlertData] = useState({})\n    const [alertShow, setAlertShow] = useState(false)\n\n    useEffect(() => {\n        let data = localStorage.getItem('items');\n        const userData = localStorage.getItem('user');\n        if (data !== null) {\n            setLstorage(JSON.parse(data));\n        }\n        if (userData !== null) {\n            setUser(JSON.parse(userData))\n        }\n    }, [])\n\n    const data = JSON.parse(localStorage.getItem('items'));\n    const total = data !== null ? (data.length > 0 ? (data.map(item => item.proPrecio).reduce((a, b) => a + b)) : 0) : 0;\n\n    const addCompra = () => {\n\n        (async () => {\n            const msg = messageGen(data);\n\n            const compra = {\n                comDescripcion: msg,\n                comPrecio: total,\n                usuId: user.usuId\n            };\n\n            const requestInit = {\n                method: 'POST',\n                headers: {'Content-Type': 'Application/json'},\n                body: JSON.stringify(compra)\n            };\n    \n            const peticion = await fetch(`https://app-restaurante-colnodo.herokuapp.com/compras`, requestInit);\n            console.log(peticion);\n        })();\n\n        const msg = messageGen(data);\n        sendClient(msg, user.usuCorreo, user.usuNombre);\n        sendManage(msg);\n\n        setAlertData({\n            message: 'Su orden de compra se ha efectuado correctamente',\n            type: 'success'\n        });\n        setAlertShow(true);\n\n        data.map(item => localStorage.removeItem(`item${item.proId}`));\n        localStorage.removeItem('items');\n        setLstorage([]);\n    }\n\n    const handleAlert = () => {\n        setAlertShow(false);\n    }\n    \n    const DelItem = key => {\n        let data = JSON.parse(localStorage.getItem('items'));\n        data = data.filter(item => item.proId !== key);\n\n        setLstorage(data);\n\n        localStorage.setItem('items', JSON.stringify(data));\n        localStorage.removeItem(`item${key}`);\n    }\n\n    const editCompra = (key, counter) => {\n        let data = JSON.parse(localStorage.getItem('items'));\n        let modElement = data.find(item => item.proId === key);\n        let modData = data.filter(item => item.proId !== key);\n        const ogPrice = modElement.proPrecio / modElement.proCantidad;\n\n        modElement.proCantidad = counter;\n        modElement.proPrecio = ogPrice * counter;\n        data = [modElement, ...modData]\n\n        setLstorage(data);\n\n        localStorage.setItem('items', JSON.stringify(data));\n        localStorage.setItem(`item${modElement.proId}`, JSON.stringify(modElement));\n    }\n    \n    const notFound = () => (\n        <div className=\"not-found\" id=\"not-found\">\n            <h2>Lo sentimos</h2>\n            <p>Aún no se ha introducido ningún producto al carrito de compras, ingrese a nuestro menú para hacerlo</p>\n        </div> \n    )\n\n    return (\n        <div className=\"buy-section\">\n            <div className=\"contenido_menu\" id=\"contenido-menu\">\n                { lstorage.length === 0 ? notFound() : lstorage.map(item => <ItemCompra key={item.proId} local={item} DelItem={DelItem} Editcompra={editCompra} />)}\n            </div>\n            <div className=\"total-section\">\n                <div className=\"content\">\n                    <p>TOTAL</p>\n                    <p id=\"precio-total\">{total}</p>\n                </div>\n                {user ? <button type=\"button\" onClick={() => addCompra()}>PAGAR AHORA</button> : <a href=\"/login\">PAGAR AHORA</a>}\n            </div>\n            <div id=\"liveAlertPlaceholder\">\n                {alertShow ? \n                (<div>\n                    <Alert alerts={alertData} reset={handleAlert} />\n                </div> ) : \n                (<div></div>) }\n            </div>\n        </div>\n    )\n}\n\nexport default BuySection;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}